<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
/>

<!-- Day of the Deal Section -->
<section class="py-5 bg-light">
  <div class="container">
    <div *ngIf="  " class="text-center">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">loading...</span>
      </div>
    </div>

    <!-- Products Grid -->
    <div *ngIf="!isLoading" class="row g-4">
      <div class="col-sm-6 col-lg-3" *ngFor="let product of allProducts">
        <div class="card h-100 shadow-sm">
          <button
            *ngIf="!product.IsFavorite"
            class="favorite-btn"
            (click)="addToFavorite(product.id)"
          >
            <i class="bi bi-heart"></i>
          </button>

          <button 
            *ngIf="product.IsFavorite"
            class="favorite-btn"
            (click)="deleteFromFavorite(product.id)"
          >
            <i class="bi bi-heart-fill text-danger"></i>
          </button>

          <div class="position-relative overflow-hidden">
            <img
              width="100%"
              height="200"
              [src]="imageBaseUrl + product.photos[0].url"
              class="card-img-top"
              [alt]="product.name"
            />
            <span class="badge bg-danger position-absolute top-0 start-0 m-2">{{
              product.descreption
            }}</span>
            <div class="position-absolute top-0 end-0 m-2 d-flex gap-2">
              <a href="#" class="btn btn-sm btn-light" title="Wishlist">
                <i class="bi bi-heart"></i>
              </a>
                <a [attr.href]="'/ProductDetails/' + product.id" class="btn btn-sm btn-light" title="Quick View">
                  <i class="bi bi-eye"></i>
                </a>
            </div>
          </div>
          <div class="card-body d-flex flex-column">
            <h6 class="text-muted mb-1">{{ product.category.name }}</h6>
            <h5 class="card-title">{{ product.name }}</h5>
            <div class="mb-2">
              <span
                *ngIf="product.discountedPrice"
                class="text-primary fw-bold"
              >
                ${{ product.discountedPrice }}
              </span>
              <span
                [ngClass]="{
                  'text-primary fw-bold': false,
                  'text-muted ms-2 text-decoration-line-through':
                    product.discountedPrice &&
                    product.discountedPrice < product.sellingPrice
                }"
              >
                ${{ product.sellingPrice }}
              </span>
            </div>
            <div class="mt-auto">
              <a href="#" class="btn btn-outline-primary w-100">
                <i class="bi bi-cart-plus me-1"></i> Add to Cart
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
